Public Class MainForm

    Const MAX_ROW = 8
    Const SIZE_BOX = 30
    Const SIZE_BORDER = 1

    Dim BlackPen As New SolidBrush(Color.Black)
    Dim WhitePen As New SolidBrush(Color.White)
    Dim GridColor As Color = SystemColors.ControlDark
    Dim BM As Bitmap
    Dim G As Graphics
    Dim FalseColor As Color
    Dim TrueColor As Color
    Dim StringForParse As String
    Dim arr(MAX_ROW)

#Region "GUI control methods"
    Private Sub MainForm_Load(ByVal sender As System.Object, ByVal evt As System.EventArgs) Handles MyBase.Load

        rbSelectMode.Checked = True
        rbEditMode.Checked = False

        TrueColor = Color.FromArgb(255, 0, 0, 0)
        FalseColor = Color.FromArgb(255, 255, 255, 255)

        BM = New Bitmap(400, 400)
        G = Graphics.FromImage(BM)

        Image_Clear()
        cbRotateCount.SelectedIndex = 0
        tbDataOfChar.Text = "0x7E,0x81,0x95,0xB1,0xB1,0x95,0x81,0x7E"

        DataOfCharToArray()
        ArrayToImage()
    End Sub

    Private Sub MainPictureBox_Click(ByVal sender As System.Object, ByVal evt As MouseEventArgs) Handles MainPictureBox.MouseClick

        Dim color = BM.GetPixel(evt.X, evt.Y)
        Dim rect As Rectangle

        rect.Width = SIZE_BOX
        rect.Height = SIZE_BOX

        For i = 1 To (SIZE_BOX + SIZE_BORDER) * MAX_ROW Step (SIZE_BOX + (SIZE_BORDER * 2))
            If evt.X >= i And evt.X < i + (SIZE_BOX + (SIZE_BORDER * 2)) Then
                rect.X = i
                Exit For
            End If
        Next

        For j = 1 To (SIZE_BOX + SIZE_BORDER) * MAX_ROW Step (SIZE_BOX + (SIZE_BORDER * 2))
            If evt.Y >= j And evt.Y < j + (SIZE_BOX + (SIZE_BORDER * 2)) Then
                rect.Y = j
                Exit For
            End If
        Next

        If color = FalseColor Then
            G.FillRectangle(BlackPen, rect)
        ElseIf color = TrueColor Then
            G.FillRectangle(WhitePen, rect)
        Else
            G.FillRectangle(BlackPen, rect)
        End If

        MainPictureBox.Image = BM
        ImageToArray()
    End Sub

    Private Sub RotateCCW(sender As Object, evt As EventArgs) Handles btRotateCCW.Click
        RotateBw()
    End Sub

    Private Sub RotateCW(sender As Object, evt As EventArgs) Handles btRotateCW.Click
        RotateFw()
    End Sub

    Private Sub SrcTextBox_MouseDown(ByVal sender As Object, ByVal evt As MouseEventArgs) Handles SourceTextBox.MouseDown
        TextBoxToImage(sender, evt)
    End Sub

    Private Sub ResultTextBox_MouseDown(ByVal sender As Object, ByVal evt As MouseEventArgs) Handles ResultTextBox.MouseDown
        TextBoxToImage(sender, evt)
    End Sub

    Private Sub btLoadDefaultFont_Click(sender As Object, evt As EventArgs) Handles btLoadDefFont.Click

        SourceTextBox.Clear()

        Dim str As String = "0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00  0x00	" & vbCrLf &
                            "0x7E, 0x81, 0x95, 0xB1, 0xB1, 0x95, 0x81, 0x7E  0x01	" & vbCrLf &
                            "0x7E, 0xFF, 0xEB, 0xCF, 0xCF, 0xEB, 0xFF, 0x7E  0x02	" & vbCrLf &
                            "0x0E, 0x1F, 0x3F, 0x7E, 0x3F, 0x1F, 0x0E, 0x00  0x03	" & vbCrLf &
                            "0x08, 0x1C, 0x3E, 0x7F, 0x3E, 0x1C, 0x08, 0x00  0x04	" & vbCrLf &
                            "0x18, 0xBA, 0xFF, 0xFF, 0xFF, 0xBA, 0x18, 0x00  0x05	" & vbCrLf &
                            "0x10, 0xB8, 0xFC, 0xFF, 0xFC, 0xB8, 0x10, 0x00  0x06	" & vbCrLf &
                            "0x00, 0x00, 0x18, 0x3C, 0x3C, 0x18, 0x00, 0x00  0x07	" & vbCrLf &
                            "0xFF, 0xFF, 0xE7, 0xC3, 0xC3, 0xE7, 0xFF, 0xFF  0x08	" & vbCrLf &
                            "0x00, 0x3C, 0x66, 0x42, 0x42, 0x66, 0x3C, 0x00  0x09	" & vbCrLf &
                            "0xFF, 0xC3, 0x99, 0xBD, 0xBD, 0x99, 0xC3, 0xFF  0x0A	" & vbCrLf &
                            "0x70, 0xF8, 0x88, 0x88, 0xFD, 0x7F, 0x07, 0x0F  0x0B	" & vbCrLf &
                            "0x00, 0x4E, 0x5F, 0xF1, 0xF1, 0x5F, 0x4E, 0x00  0x0C	" & vbCrLf &
                            "0xC0, 0xE0, 0xFF, 0x7F, 0x05, 0x05, 0x07, 0x07  0x0D	" & vbCrLf &
                            "0xC0, 0xFF, 0x7F, 0x05, 0x05, 0x65, 0x7F, 0x3F  0x0E	" & vbCrLf &
                            "0x99, 0x5A, 0x3C, 0xE7, 0xE7, 0x3C, 0x5A, 0x99  0x0F	" & vbCrLf &
                            "0x7F, 0x3E, 0x3E, 0x1C, 0x1C, 0x08, 0x08, 0x00  0x10	" & vbCrLf &
                            "0x08, 0x08, 0x1C, 0x1C, 0x3E, 0x3E, 0x7F, 0x00  0x11	" & vbCrLf &
                            "0x00, 0x24, 0x66, 0xFF, 0xFF, 0x66, 0x24, 0x00  0x12	" & vbCrLf &
                            "0x00, 0x5F, 0x5F, 0x00, 0x00, 0x5F, 0x5F, 0x00  0x13	" & vbCrLf &
                            "0x06, 0x0F, 0x09, 0x7F, 0x7F, 0x01, 0x7F, 0x7F  0x14	" & vbCrLf &
                            "0x40, 0xDA, 0xBF, 0xA5, 0xFD, 0x59, 0x03, 0x02  0x15	" & vbCrLf &
                            "0x00, 0x70, 0x70, 0x70, 0x70, 0x70, 0x70, 0x00  0x16	" & vbCrLf &
                            "0x80, 0x94, 0xB6, 0xFF, 0xFF, 0xB6, 0x94, 0x80  0x17	" & vbCrLf &
                            "0x00, 0x04, 0x06, 0x7F, 0x7F, 0x06, 0x04, 0x00  0x18	" & vbCrLf &
                            "0x00, 0x10, 0x30, 0x7F, 0x7F, 0x30, 0x10, 0x00  0x19	" & vbCrLf &
                            "0x08, 0x08, 0x08, 0x2A, 0x3E, 0x1C, 0x08, 0x00  0x1A	" & vbCrLf &
                            "0x08, 0x1C, 0x3E, 0x2A, 0x08, 0x08, 0x08, 0x00  0x1B	" & vbCrLf &
                            "0x3C, 0x3C, 0x20, 0x20, 0x20, 0x20, 0x20, 0x00  0x1C	" & vbCrLf &
                            "0x08, 0x1C, 0x3E, 0x08, 0x08, 0x3E, 0x1C, 0x08  0x1D	" & vbCrLf &
                            "0x30, 0x38, 0x3C, 0x3E, 0x3E, 0x3C, 0x38, 0x30  0x1E	" & vbCrLf &
                            "0x06, 0x0E, 0x1E, 0x3E, 0x3E, 0x1E, 0x0E, 0x06  0x1F	" & vbCrLf &
                            "0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00  ' '	" & vbCrLf &
                            "0x00, 0x06, 0x5F, 0x5F, 0x06, 0x00, 0x00, 0x00  '!'	" & vbCrLf &
                            "0x00, 0x07, 0x07, 0x00, 0x07, 0x07, 0x00, 0x00  ''' '	" & vbCrLf &
                            "0x14, 0x7F, 0x7F, 0x14, 0x7F, 0x7F, 0x14, 0x00  '#'	" & vbCrLf &
                            "0x24, 0x2E, 0x6B, 0x6B, 0x3A, 0x12, 0x00, 0x00  '$'	" & vbCrLf &
                            "0x46, 0x66, 0x30, 0x18, 0x0C, 0x66, 0x62, 0x00  '%'	" & vbCrLf &
                            "0x30, 0x7A, 0x4F, 0x5D, 0x37, 0x7A, 0x48, 0x00  '&'	" & vbCrLf &
                            "0x04, 0x07, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00  '''	" & vbCrLf &
                            "0x00, 0x1C, 0x3E, 0x63, 0x41, 0x00, 0x00, 0x00  '('	" & vbCrLf &
                            "0x00, 0x41, 0x63, 0x3E, 0x1C, 0x00, 0x00, 0x00  ')'	" & vbCrLf &
                            "0x08, 0x2A, 0x3E, 0x1C, 0x1C, 0x3E, 0x2A, 0x08  '*'	" & vbCrLf &
                            "0x08, 0x08, 0x3E, 0x3E, 0x08, 0x08, 0x00, 0x00  '+'	" & vbCrLf &
                            "0x00, 0x80, 0xE0, 0x60, 0x00, 0x00, 0x00, 0x00  ','	" & vbCrLf &
                            "0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x00, 0x00  '-'	" & vbCrLf &
                            "0x00, 0x00, 0x60, 0x60, 0x00, 0x00, 0x00, 0x00  '.'	" & vbCrLf &
                            "0x60, 0x30, 0x18, 0x0C, 0x06, 0x03, 0x01, 0x00  '/'	" & vbCrLf &
                            "0x3E, 0x7F, 0x71, 0x59, 0x4D, 0x7F, 0x3E, 0x00  '0'	" & vbCrLf &
                            "0x40, 0x42, 0x7F, 0x7F, 0x40, 0x40, 0x00, 0x00  '1'	" & vbCrLf &
                            "0x62, 0x73, 0x59, 0x49, 0x6F, 0x66, 0x00, 0x00  '2'	" & vbCrLf &
                            "0x22, 0x63, 0x49, 0x49, 0x7F, 0x36, 0x00, 0x00  '3'	" & vbCrLf &
                            "0x18, 0x1C, 0x16, 0x53, 0x7F, 0x7F, 0x50, 0x00  '4'	" & vbCrLf &
                            "0x27, 0x67, 0x45, 0x45, 0x7D, 0x39, 0x00, 0x00  '5'	" & vbCrLf &
                            "0x3C, 0x7E, 0x4B, 0x49, 0x79, 0x30, 0x00, 0x00  '6'	" & vbCrLf &
                            "0x03, 0x03, 0x71, 0x79, 0x0F, 0x07, 0x00, 0x00  '7'	" & vbCrLf &
                            "0x36, 0x7F, 0x49, 0x49, 0x7F, 0x36, 0x00, 0x00  '8'	" & vbCrLf &
                            "0x06, 0x4F, 0x49, 0x69, 0x3F, 0x1E, 0x00, 0x00  '9'	" & vbCrLf &
                            "0x00, 0x00, 0x66, 0x66, 0x00, 0x00, 0x00, 0x00  ':'	" & vbCrLf &
                            "0x00, 0x80, 0xE6, 0x66, 0x00, 0x00, 0x00, 0x00  ';'	" & vbCrLf &
                            "0x08, 0x1C, 0x36, 0x63, 0x41, 0x00, 0x00, 0x00  '<'	" & vbCrLf &
                            "0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x00, 0x00  '='	" & vbCrLf &
                            "0x00, 0x41, 0x63, 0x36, 0x1C, 0x08, 0x00, 0x00  '>'	" & vbCrLf &
                            "0x02, 0x03, 0x51, 0x59, 0x0F, 0x06, 0x00, 0x00  '?'	" & vbCrLf &
                            "0x3E, 0x7F, 0x41, 0x5D, 0x5D, 0x1F, 0x1E, 0x00  '@'	" & vbCrLf &
                            "0x7C, 0x7E, 0x13, 0x13, 0x7E, 0x7C, 0x00, 0x00  'A'	" & vbCrLf &
                            "0x41, 0x7F, 0x7F, 0x49, 0x49, 0x7F, 0x36, 0x00  'B'	" & vbCrLf &
                            "0x1C, 0x3E, 0x63, 0x41, 0x41, 0x63, 0x22, 0x00  'C'	" & vbCrLf &
                            "0x41, 0x7F, 0x7F, 0x41, 0x63, 0x3E, 0x1C, 0x00  'D'	" & vbCrLf &
                            "0x41, 0x7F, 0x7F, 0x49, 0x5D, 0x41, 0x63, 0x00  'E'	" & vbCrLf &
                            "0x41, 0x7F, 0x7F, 0x49, 0x1D, 0x01, 0x03, 0x00  'F'	" & vbCrLf &
                            "0x1C, 0x3E, 0x63, 0x41, 0x51, 0x73, 0x72, 0x00  'G'	" & vbCrLf &
                            "0x7F, 0x7F, 0x08, 0x08, 0x7F, 0x7F, 0x00, 0x00  'H'	" & vbCrLf &
                            "0x00, 0x41, 0x7F, 0x7F, 0x41, 0x00, 0x00, 0x00  'I'	" & vbCrLf &
                            "0x30, 0x70, 0x40, 0x41, 0x7F, 0x3F, 0x01, 0x00  'J'	" & vbCrLf &
                            "0x41, 0x7F, 0x7F, 0x08, 0x1C, 0x77, 0x63, 0x00  'K'	" & vbCrLf &
                            "0x41, 0x7F, 0x7F, 0x41, 0x40, 0x60, 0x70, 0x00  'L'	" & vbCrLf &
                            "0x7F, 0x7F, 0x0E, 0x1C, 0x0E, 0x7F, 0x7F, 0x00  'M'	" & vbCrLf &
                            "0x7F, 0x7F, 0x06, 0x0C, 0x18, 0x7F, 0x7F, 0x00  'N'	" & vbCrLf &
                            "0x1C, 0x3E, 0x63, 0x41, 0x63, 0x3E, 0x1C, 0x00  'O'	" & vbCrLf &
                            "0x41, 0x7F, 0x7F, 0x49, 0x09, 0x0F, 0x06, 0x00  'P'	" & vbCrLf &
                            "0x1E, 0x3F, 0x21, 0x71, 0x7F, 0x5E, 0x00, 0x00  'Q'	" & vbCrLf &
                            "0x41, 0x7F, 0x7F, 0x09, 0x19, 0x7F, 0x66, 0x00  'R'	" & vbCrLf &
                            "0x26, 0x6F, 0x4D, 0x59, 0x73, 0x32, 0x00, 0x00  'S'	" & vbCrLf &
                            "0x03, 0x41, 0x7F, 0x7F, 0x41, 0x03, 0x00, 0x00  'T'	" & vbCrLf &
                            "0x7F, 0x7F, 0x40, 0x40, 0x7F, 0x7F, 0x00, 0x00  'U'	" & vbCrLf &
                            "0x1F, 0x3F, 0x60, 0x60, 0x3F, 0x1F, 0x00, 0x00  'V'	" & vbCrLf &
                            "0x7F, 0x7F, 0x30, 0x18, 0x30, 0x7F, 0x7F, 0x00  'W'	" & vbCrLf &
                            "0x43, 0x67, 0x3C, 0x18, 0x3C, 0x67, 0x43, 0x00  'X'	" & vbCrLf &
                            "0x07, 0x4F, 0x78, 0x78, 0x4F, 0x07, 0x00, 0x00  'Y'	" & vbCrLf &
                            "0x47, 0x63, 0x71, 0x59, 0x4D, 0x67, 0x73, 0x00  'Z'	" & vbCrLf &
                            "0x00, 0x7F, 0x7F, 0x41, 0x41, 0x00, 0x00, 0x00  '['	" & vbCrLf &
                            "0x01, 0x03, 0x06, 0x0C, 0x18, 0x30, 0x60, 0x00  '\'	" & vbCrLf &
                            "0x00, 0x41, 0x41, 0x7F, 0x7F, 0x00, 0x00, 0x00  ']'	" & vbCrLf &
                            "0x08, 0x0C, 0x06, 0x03, 0x06, 0x0C, 0x08, 0x00  '^'	" & vbCrLf &
                            "0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80  '_'	" & vbCrLf &
                            "0x00, 0x00, 0x03, 0x07, 0x04, 0x00, 0x00, 0x00  '`'	" & vbCrLf &
                            "0x20, 0x74, 0x54, 0x54, 0x3C, 0x78, 0x40, 0x00  'a'	" & vbCrLf &
                            "0x41, 0x7F, 0x3F, 0x48, 0x48, 0x78, 0x30, 0x00  'b'	" & vbCrLf &
                            "0x38, 0x7C, 0x44, 0x44, 0x6C, 0x28, 0x00, 0x00  'c'	" & vbCrLf &
                            "0x30, 0x78, 0x48, 0x49, 0x3F, 0x7F, 0x40, 0x00  'd'	" & vbCrLf &
                            "0x38, 0x7C, 0x54, 0x54, 0x5C, 0x18, 0x00, 0x00  'evt'	" & vbCrLf &
                            "0x48, 0x7E, 0x7F, 0x49, 0x03, 0x02, 0x00, 0x00  'f'	" & vbCrLf &
                            "0x98, 0xBC, 0xA4, 0xA4, 0xF8, 0x7C, 0x04, 0x00  'g'	" & vbCrLf &
                            "0x41, 0x7F, 0x7F, 0x08, 0x04, 0x7C, 0x78, 0x00  'h'	" & vbCrLf &
                            "0x00, 0x44, 0x7D, 0x7D, 0x40, 0x00, 0x00, 0x00  'i'	" & vbCrLf &
                            "0x60, 0xE0, 0x80, 0x80, 0xFD, 0x7D, 0x00, 0x00  'j'	" & vbCrLf &
                            "0x41, 0x7F, 0x7F, 0x10, 0x38, 0x6C, 0x44, 0x00  'k'	" & vbCrLf &
                            "0x00, 0x41, 0x7F, 0x7F, 0x40, 0x00, 0x00, 0x00  'l'	" & vbCrLf &
                            "0x7C, 0x7C, 0x18, 0x38, 0x1C, 0x7C, 0x78, 0x00  'm'	" & vbCrLf &
                            "0x7C, 0x7C, 0x04, 0x04, 0x7C, 0x78, 0x00, 0x00  'n'	" & vbCrLf &
                            "0x38, 0x7C, 0x44, 0x44, 0x7C, 0x38, 0x00, 0x00  'o'	" & vbCrLf &
                            "0x84, 0xFC, 0xF8, 0xA4, 0x24, 0x3C, 0x18, 0x00  'p'	" & vbCrLf &
                            "0x18, 0x3C, 0x24, 0xA4, 0xF8, 0xFC, 0x84, 0x00  'q'	" & vbCrLf &
                            "0x44, 0x7C, 0x78, 0x4C, 0x04, 0x1C, 0x18, 0x00  'r'	" & vbCrLf &
                            "0x48, 0x5C, 0x54, 0x54, 0x74, 0x24, 0x00, 0x00  's'	" & vbCrLf &
                            "0x00, 0x04, 0x3E, 0x7F, 0x44, 0x24, 0x00, 0x00  't'	" & vbCrLf &
                            "0x3C, 0x7C, 0x40, 0x40, 0x3C, 0x7C, 0x40, 0x00  'u'	" & vbCrLf &
                            "0x1C, 0x3C, 0x60, 0x60, 0x3C, 0x1C, 0x00, 0x00  'v'	" & vbCrLf &
                            "0x3C, 0x7C, 0x70, 0x38, 0x70, 0x7C, 0x3C, 0x00  'w'	" & vbCrLf &
                            "0x44, 0x6C, 0x38, 0x10, 0x38, 0x6C, 0x44, 0x00  'x'	" & vbCrLf &
                            "0x9C, 0xBC, 0xA0, 0xA0, 0xFC, 0x7C, 0x00, 0x00  'y'	" & vbCrLf &
                            "0x4C, 0x64, 0x74, 0x5C, 0x4C, 0x64, 0x00, 0x00  'z'	" & vbCrLf &
                            "0x08, 0x08, 0x3E, 0x77, 0x41, 0x41, 0x00, 0x00  ''	    " & vbCrLf &
                            "0x00, 0x00, 0x00, 0x77, 0x77, 0x00, 0x00, 0x00  '|'	" & vbCrLf &
                            "0x41, 0x41, 0x77, 0x3E, 0x08, 0x08, 0x00, 0x00  '}'	" & vbCrLf &
                            "0x02, 0x03, 0x01, 0x03, 0x02, 0x03, 0x01, 0x00  '~'	" & vbCrLf &
                            "0x70, 0x78, 0x4C, 0x46, 0x4C, 0x78, 0x70, 0x00  0x7F	" & vbCrLf &
                            "0x0E, 0x9F, 0x91, 0xB1, 0xFB, 0x4A, 0x00, 0x00  0x80	" & vbCrLf &
                            "0x3A, 0x7A, 0x40, 0x40, 0x7A, 0x7A, 0x40, 0x00  0x81	" & vbCrLf &
                            "0x38, 0x7C, 0x54, 0x55, 0x5D, 0x19, 0x00, 0x00  0x82	" & vbCrLf &
                            "0x02, 0x23, 0x75, 0x55, 0x55, 0x7D, 0x7B, 0x42  0x83	" & vbCrLf &
                            "0x21, 0x75, 0x54, 0x54, 0x7D, 0x79, 0x40, 0x00  0x84	" & vbCrLf &
                            "0x21, 0x75, 0x55, 0x54, 0x7C, 0x78, 0x40, 0x00  0x85	" & vbCrLf &
                            "0x20, 0x74, 0x57, 0x57, 0x7C, 0x78, 0x40, 0x00  0x86	" & vbCrLf &
                            "0x18, 0x3C, 0xA4, 0xA4, 0xE4, 0x40, 0x00, 0x00  0x87	" & vbCrLf &
                            "0x02, 0x3B, 0x7D, 0x55, 0x55, 0x5D, 0x1B, 0x02  0x88	" & vbCrLf &
                            "0x39, 0x7D, 0x54, 0x54, 0x5D, 0x19, 0x00, 0x00  0x89	" & vbCrLf &
                            "0x39, 0x7D, 0x55, 0x54, 0x5C, 0x18, 0x00, 0x00  0x8A	" & vbCrLf &
                            "0x01, 0x45, 0x7C, 0x7C, 0x41, 0x01, 0x00, 0x00  0x8B	" & vbCrLf &
                            "0x02, 0x03, 0x45, 0x7D, 0x7D, 0x43, 0x02, 0x00  0x8C	" & vbCrLf &
                            "0x01, 0x45, 0x7D, 0x7C, 0x40, 0x00, 0x00, 0x00  0x8D	" & vbCrLf &
                            "0x79, 0x7D, 0x16, 0x12, 0x16, 0x7D, 0x79, 0x00  0x8E	" & vbCrLf &
                            "0x70, 0x78, 0x2B, 0x2B, 0x78, 0x70, 0x00, 0x00  0x8F	" & vbCrLf &
                            "0x44, 0x7C, 0x7C, 0x55, 0x55, 0x45, 0x00, 0x00  0x90	" & vbCrLf &
                            "0x20, 0x74, 0x54, 0x54, 0x7C, 0x7C, 0x54, 0x54  0x91	" & vbCrLf &
                            "0x7C, 0x7E, 0x0B, 0x09, 0x7F, 0x7F, 0x49, 0x00  0x92	" & vbCrLf &
                            "0x32, 0x7B, 0x49, 0x49, 0x7B, 0x32, 0x00, 0x00  0x93	" & vbCrLf &
                            "0x32, 0x7A, 0x48, 0x48, 0x7A, 0x32, 0x00, 0x00  0x94	" & vbCrLf &
                            "0x32, 0x7A, 0x4A, 0x48, 0x78, 0x30, 0x00, 0x00  0x95	" & vbCrLf &
                            "0x3A, 0x7B, 0x41, 0x41, 0x7B, 0x7A, 0x40, 0x00  0x96	" & vbCrLf &
                            "0x3A, 0x7A, 0x42, 0x40, 0x78, 0x78, 0x40, 0x00  0x97	" & vbCrLf &
                            "0x9A, 0xBA, 0xA0, 0xA0, 0xFA, 0x7A, 0x00, 0x00  0x98	" & vbCrLf &
                            "0x01, 0x19, 0x3C, 0x66, 0x66, 0x3C, 0x19, 0x01  0x99	" & vbCrLf &
                            "0x3D, 0x7D, 0x40, 0x40, 0x7D, 0x3D, 0x00, 0x00  0x9A	" & vbCrLf &
                            "0x18, 0x3C, 0x24, 0xE7, 0xE7, 0x24, 0x24, 0x00  0x9B	" & vbCrLf &
                            "0x68, 0x7E, 0x7F, 0x49, 0x43, 0x66, 0x20, 0x00  0x9C	" & vbCrLf &
                            "0x2B, 0x2F, 0xFC, 0xFC, 0x2F, 0x2B, 0x00, 0x00  0x9D	" & vbCrLf &
                            "0xFF, 0xFF, 0x09, 0x09, 0x2F, 0xF6, 0xF8, 0xA0  0x9E	" & vbCrLf &
                            "0x40, 0xC0, 0x88, 0xFE, 0x7F, 0x09, 0x03, 0x02  0x9F	" & vbCrLf &
                            "0x20, 0x74, 0x54, 0x55, 0x7D, 0x79, 0x40, 0x00  0xA0	" & vbCrLf &
                            "0x00, 0x44, 0x7D, 0x7D, 0x41, 0x00, 0x00, 0x00  0xA1	" & vbCrLf &
                            "0x30, 0x78, 0x48, 0x4A, 0x7A, 0x32, 0x00, 0x00  0xA2	" & vbCrLf &
                            "0x38, 0x78, 0x40, 0x42, 0x7A, 0x7A, 0x40, 0x00  0xA3	" & vbCrLf &
                            "0x7A, 0x7A, 0x0A, 0x0A, 0x7A, 0x70, 0x00, 0x00  0xA4	" & vbCrLf &
                            "0x7D, 0x7D, 0x19, 0x31, 0x7D, 0x7D, 0x00, 0x00  0xA5	" & vbCrLf &
                            "0x00, 0x26, 0x2F, 0x29, 0x2F, 0x2F, 0x28, 0x00  0xA6	" & vbCrLf &
                            "0x00, 0x26, 0x2F, 0x29, 0x2F, 0x26, 0x00, 0x00  0xA7	" & vbCrLf &
                            "0x30, 0x78, 0x4D, 0x45, 0x60, 0x20, 0x00, 0x00  0xA8	" & vbCrLf &
                            "0x38, 0x38, 0x08, 0x08, 0x08, 0x08, 0x00, 0x00  0xA9	" & vbCrLf &
                            "0x08, 0x08, 0x08, 0x08, 0x38, 0x38, 0x00, 0x00  0xAA	" & vbCrLf &
                            "0x4F, 0x6F, 0x30, 0x18, 0xCC, 0xEE, 0xBB, 0x91  0xAB	" & vbCrLf &
                            "0x4F, 0x6F, 0x30, 0x18, 0x6C, 0x76, 0xFB, 0xF9  0xAC	" & vbCrLf &
                            "0x00, 0x00, 0x00, 0x7B, 0x7B, 0x00, 0x00, 0x00  0xAD	" & vbCrLf &
                            "0x08, 0x1C, 0x36, 0x22, 0x08, 0x1C, 0x36, 0x22  0xAE	" & vbCrLf &
                            "0x22, 0x36, 0x1C, 0x08, 0x22, 0x36, 0x1C, 0x08  0xAF	" & vbCrLf &
                            "0xAA, 0x00, 0x55, 0x00, 0xAA, 0x00, 0x55, 0x00  0xB0	" & vbCrLf &
                            "0xAA, 0x55, 0xAA, 0x55, 0xAA, 0x55, 0xAA, 0x55  0xB1	" & vbCrLf &
                            "0xDD, 0xFF, 0xAA, 0x77, 0xDD, 0xAA, 0xFF, 0x77  0xB2	" & vbCrLf &
                            "0x00, 0x00, 0x00, 0xFF, 0xFF, 0x00, 0x00, 0x00  0xB3	" & vbCrLf &
                            "0x10, 0x10, 0x10, 0xFF, 0xFF, 0x00, 0x00, 0x00  0xB4	" & vbCrLf &
                            "0x14, 0x14, 0x14, 0xFF, 0xFF, 0x00, 0x00, 0x00  0xB5	" & vbCrLf &
                            "0x10, 0x10, 0xFF, 0xFF, 0x00, 0xFF, 0xFF, 0x00  0xB6	" & vbCrLf &
                            "0x10, 0x10, 0xF0, 0xF0, 0x10, 0xF0, 0xF0, 0x00  0xB7	" & vbCrLf &
                            "0x14, 0x14, 0x14, 0xFC, 0xFC, 0x00, 0x00, 0x00  0xB8	" & vbCrLf &
                            "0x14, 0x14, 0xF7, 0xF7, 0x00, 0xFF, 0xFF, 0x00  0xB9	" & vbCrLf &
                            "0x00, 0x00, 0xFF, 0xFF, 0x00, 0xFF, 0xFF, 0x00  0xBA	" & vbCrLf &
                            "0x14, 0x14, 0xF4, 0xF4, 0x04, 0xFC, 0xFC, 0x00  0xBB	" & vbCrLf &
                            "0x14, 0x14, 0x17, 0x17, 0x10, 0x1F, 0x1F, 0x00  0xBC	" & vbCrLf &
                            "0x10, 0x10, 0x1F, 0x1F, 0x10, 0x1F, 0x1F, 0x00  0xBD	" & vbCrLf &
                            "0x14, 0x14, 0x14, 0x1F, 0x1F, 0x00, 0x00, 0x00  0xBE	" & vbCrLf &
                            "0x10, 0x10, 0x10, 0xF0, 0xF0, 0x00, 0x00, 0x00  0xBF	" & vbCrLf &
                            "0x00, 0x00, 0x00, 0x1F, 0x1F, 0x10, 0x10, 0x10  0xC0	" & vbCrLf &
                            "0x10, 0x10, 0x10, 0x1F, 0x1F, 0x10, 0x10, 0x10  0xC1	" & vbCrLf &
                            "0x10, 0x10, 0x10, 0xF0, 0xF0, 0x10, 0x10, 0x10  0xC2	" & vbCrLf &
                            "0x00, 0x00, 0x00, 0xFF, 0xFF, 0x10, 0x10, 0x10  0xC3	" & vbCrLf &
                            "0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10  0xC4	" & vbCrLf &
                            "0x10, 0x10, 0x10, 0xFF, 0xFF, 0x10, 0x10, 0x10  0xC5	" & vbCrLf &
                            "0x00, 0x00, 0x00, 0xFF, 0xFF, 0x14, 0x14, 0x14  0xC6	" & vbCrLf &
                            "0x00, 0x00, 0xFF, 0xFF, 0x00, 0xFF, 0xFF, 0x10  0xC7	" & vbCrLf &
                            "0x00, 0x00, 0x1F, 0x1F, 0x10, 0x17, 0x17, 0x14  0xC8	" & vbCrLf &
                            "0x00, 0x00, 0xFC, 0xFC, 0x04, 0xF4, 0xF4, 0x14  0xC9	" & vbCrLf &
                            "0x14, 0x14, 0x17, 0x17, 0x10, 0x17, 0x17, 0x14  0xCA	" & vbCrLf &
                            "0x14, 0x14, 0xF4, 0xF4, 0x04, 0xF4, 0xF4, 0x14  0xCB	" & vbCrLf &
                            "0x00, 0x00, 0xFF, 0xFF, 0x00, 0xF7, 0xF7, 0x14  0xCC	" & vbCrLf &
                            "0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14  0xCD	" & vbCrLf &
                            "0x14, 0x14, 0xF7, 0xF7, 0x00, 0xF7, 0xF7, 0x14  0xCE	" & vbCrLf &
                            "0x14, 0x14, 0x14, 0x17, 0x17, 0x14, 0x14, 0x14  0xCF	" & vbCrLf &
                            "0x10, 0x10, 0x1F, 0x1F, 0x10, 0x1F, 0x1F, 0x10  0xD0	" & vbCrLf &
                            "0x14, 0x14, 0x14, 0xF4, 0xF4, 0x14, 0x14, 0x14  0xD1	" & vbCrLf &
                            "0x10, 0x10, 0xF0, 0xF0, 0x10, 0xF0, 0xF0, 0x10  0xD2	" & vbCrLf &
                            "0x00, 0x00, 0x1F, 0x1F, 0x10, 0x1F, 0x1F, 0x10  0xD3	" & vbCrLf &
                            "0x00, 0x00, 0x00, 0x1F, 0x1F, 0x14, 0x14, 0x14  0xD4	" & vbCrLf &
                            "0x00, 0x00, 0x00, 0xFC, 0xFC, 0x14, 0x14, 0x14  0xD5	" & vbCrLf &
                            "0x00, 0x00, 0xF0, 0xF0, 0x10, 0xF0, 0xF0, 0x10  0xD6	" & vbCrLf &
                            "0x10, 0x10, 0xFF, 0xFF, 0x10, 0xFF, 0xFF, 0x10  0xD7	" & vbCrLf &
                            "0x14, 0x14, 0x14, 0xFF, 0xFF, 0x14, 0x14, 0x14  0xD8	" & vbCrLf &
                            "0x10, 0x10, 0x10, 0x1F, 0x1F, 0x00, 0x00, 0x00  0xD9	" & vbCrLf &
                            "0x00, 0x00, 0x00, 0xF0, 0xF0, 0x10, 0x10, 0x10  0xDA	" & vbCrLf &
                            "0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF  0xDB	" & vbCrLf &
                            "0xF0, 0xF0, 0xF0, 0xF0, 0xF0, 0xF0, 0xF0, 0xF0  0xDC	" & vbCrLf &
                            "0xFF, 0xFF, 0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00  0xDD	" & vbCrLf &
                            "0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0xFF, 0xFF  0xDE	" & vbCrLf &
                            "0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F  0xDF	" & vbCrLf &
                            "0x38, 0x7C, 0x44, 0x6C, 0x38, 0x6C, 0x44, 0x00  0xE0	" & vbCrLf &
                            "0xFC, 0xFE, 0x2A, 0x2A, 0x3E, 0x14, 0x00, 0x00  0xE1	" & vbCrLf &
                            "0x7E, 0x7E, 0x02, 0x02, 0x06, 0x06, 0x00, 0x00  0xE2	" & vbCrLf &
                            "0x02, 0x7E, 0x7E, 0x02, 0x7E, 0x7E, 0x02, 0x00  0xE3	" & vbCrLf &
                            "0x63, 0x77, 0x5D, 0x49, 0x63, 0x63, 0x00, 0x00  0xE4	" & vbCrLf &
                            "0x38, 0x7C, 0x44, 0x7C, 0x3C, 0x04, 0x04, 0x00  0xE5	" & vbCrLf &
                            "0x80, 0xFE, 0x7E, 0x20, 0x20, 0x3E, 0x1E, 0x00  0xE6	" & vbCrLf &
                            "0x04, 0x06, 0x02, 0x7E, 0x7C, 0x06, 0x02, 0x00  0xE7	" & vbCrLf &
                            "0x99, 0xBD, 0xE7, 0xE7, 0xBD, 0x99, 0x00, 0x00  0xE8	" & vbCrLf &
                            "0x1C, 0x3E, 0x6B, 0x49, 0x6B, 0x3E, 0x1C, 0x00  0xE9	" & vbCrLf &
                            "0x4C, 0x7E, 0x73, 0x01, 0x73, 0x7E, 0x4C, 0x00  0xEA	" & vbCrLf &
                            "0x30, 0x78, 0x4A, 0x4F, 0x7D, 0x39, 0x00, 0x00  0xEB	" & vbCrLf &
                            "0x18, 0x3C, 0x24, 0x3C, 0x3C, 0x24, 0x3C, 0x18  0xEC	" & vbCrLf &
                            "0x98, 0xFC, 0x64, 0x3C, 0x3E, 0x27, 0x3D, 0x18  0xED	" & vbCrLf &
                            "0x1C, 0x3E, 0x6B, 0x49, 0x49, 0x00, 0x00, 0x00  0xEE	" & vbCrLf &
                            "0x7E, 0x7F, 0x01, 0x01, 0x7F, 0x7E, 0x00, 0x00  0xEF	" & vbCrLf &
                            "0x2A, 0x2A, 0x2A, 0x2A, 0x2A, 0x2A, 0x00, 0x00  0xF0	" & vbCrLf &
                            "0x44, 0x44, 0x5F, 0x5F, 0x44, 0x44, 0x00, 0x00  0xF1	" & vbCrLf &
                            "0x40, 0x51, 0x5B, 0x4E, 0x44, 0x40, 0x00, 0x00  0xF2	" & vbCrLf &
                            "0x40, 0x44, 0x4E, 0x5B, 0x51, 0x40, 0x00, 0x00  0xF3	" & vbCrLf &
                            "0x00, 0x00, 0x00, 0xFE, 0xFF, 0x01, 0x07, 0x06  0xF4	" & vbCrLf &
                            "0x60, 0xE0, 0x80, 0xFF, 0x7F, 0x00, 0x00, 0x00  0xF5	" & vbCrLf &
                            "0x08, 0x08, 0x6B, 0x6B, 0x08, 0x08, 0x00, 0x00  0xF6	" & vbCrLf &
                            "0x24, 0x36, 0x12, 0x36, 0x24, 0x36, 0x12, 0x00  0xF7	" & vbCrLf &
                            "0x00, 0x06, 0x0F, 0x09, 0x0F, 0x06, 0x00, 0x00  0xF8	" & vbCrLf &
                            "0x00, 0x00, 0x00, 0x18, 0x18, 0x00, 0x00, 0x00  0xF9	" & vbCrLf &
                            "0x00, 0x00, 0x00, 0x10, 0x10, 0x00, 0x00, 0x00  0xFA	" & vbCrLf &
                            "0x10, 0x30, 0x70, 0xC0, 0xFF, 0xFF, 0x01, 0x01  0xFB	" & vbCrLf &
                            "0x00, 0x1F, 0x1F, 0x01, 0x1F, 0x1E, 0x00, 0x00  0xFC	" & vbCrLf &
                            "0x00, 0x19, 0x1D, 0x17, 0x12, 0x00, 0x00, 0x00  0xFD	" & vbCrLf &
                            "0x00, 0x00, 0x3C, 0x3C, 0x3C, 0x3C, 0x00, 0x00  0xFE	" & vbCrLf &
                            "0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00  0xFF	" & vbCrLf
        SourceTextBox.Text = str
    End Sub

    Private Sub btRotate_Click(sender As Object, evt As EventArgs) Handles btRotate.Click

        ResultTextBox.Clear()
        For i = 0 To SourceTextBox.Lines.Count - 1
            ResultTextBox.AppendText(RotateHexFromStr(SourceTextBox.Lines(i)) + Environment.NewLine)
        Next
    End Sub

    Private Sub ReadTextArray(ByVal sender As System.Object, ByVal evt As System.EventArgs) Handles btReadData.Click

        DataOfCharToArray()
        ArrayToImage()
    End Sub

    Private Sub Clear(ByVal sender As System.Object, ByVal evt As System.EventArgs) Handles btClear.Click
        Image_Clear()
    End Sub

    Private Sub btInvert_Click(ByVal sender As System.Object, ByVal evt As System.EventArgs) Handles btInvert.Click
        Invert()
    End Sub
#End Region

    Sub Image_Clear()

        G.Clear(GridColor)
        For i = 0 To MAX_ROW - 1
            For j = 0 To MAX_ROW - 1
                G.FillRectangle(WhitePen, New Rectangle((i * (SIZE_BOX + (SIZE_BORDER * 2))) + 1, (j * (SIZE_BOX + (SIZE_BORDER * 2))) + 1, SIZE_BOX, SIZE_BOX))
            Next
        Next
        MainPictureBox.Image = BM
    End Sub

    Sub ImageToArray()
        Dim color

        For i = 0 To MAX_ROW - 1
            arr(i) = 0
        Next

        For i = 0 To MAX_ROW - 1
            For j = 0 To MAX_ROW - 1
                color = BM.GetPixel((i * (SIZE_BOX + (SIZE_BORDER * 2))) + 7, (j * (SIZE_BOX + (SIZE_BORDER * 2))) + 7)
                If color = TrueColor Then
                    arr(i) = arr(i) Xor (2 ^ j)
                End If
            Next
        Next

        tbDataOfChar.Text = ByteToHex(arr(0)) & "," & ByteToHex(arr(1)) & "," & ByteToHex(arr(2)) & "," & ByteToHex(arr(3)) & "," & ByteToHex(arr(4)) & "," & ByteToHex(arr(5)) & "," & ByteToHex(arr(6)) & "," & ByteToHex(arr(7))
    End Sub

    Sub ArrayToImage()

        Dim a As Byte

        For i = 0 To MAX_ROW - 1
            a = arr(i)
            For j = 0 To MAX_ROW - 1

                If a And (2 ^ j) Then

                    G.FillRectangle(BlackPen, New Rectangle((i * (SIZE_BOX + (SIZE_BORDER * 2))) + SIZE_BORDER, (j * (SIZE_BOX + (SIZE_BORDER * 2))) + SIZE_BORDER, SIZE_BOX, SIZE_BOX))
                Else
                    G.FillRectangle(WhitePen, New Rectangle((i * (SIZE_BOX + (SIZE_BORDER * 2))) + SIZE_BORDER, (j * (SIZE_BOX + (SIZE_BORDER * 2))) + SIZE_BORDER, SIZE_BOX, SIZE_BOX))
                End If

            Next
        Next
        tbDataOfChar.Text = ByteToHex(arr(0)) & "," & ByteToHex(arr(1)) & "," & ByteToHex(arr(2)) & "," & ByteToHex(arr(3)) & "," & ByteToHex(arr(4)) & "," & ByteToHex(arr(5)) & "," & ByteToHex(arr(6)) & "," & ByteToHex(arr(7))

        MainPictureBox.Image = BM
    End Sub

    Function ByteToHex(ByVal InByte) As String

        If InByte < 16 Then
            Return "0x0" & Hex(InByte)
        Else
            Return "0x" & Hex(InByte)
        End If

    End Function

    Sub DataOfCharToArray()

        Dim srcArr(8)

        srcArr = Split(tbDataOfChar.Text, ",")

        For i = 0 To MAX_ROW - 1
            arr(i) = Convert.ToInt32(srcArr(i), 16)
        Next
    End Sub

    Sub Invert()

        Dim color

        Dim arr(8) As Byte
        For i = 0 To MAX_ROW - 1
            For j = 0 To MAX_ROW - 1
                color = BM.GetPixel((i * (SIZE_BOX + (SIZE_BORDER * 2))) + CInt(SIZE_BOX / 2), (j * (SIZE_BOX + (SIZE_BORDER * 2))) + CInt(SIZE_BOX / 2))
                If color = TrueColor Then
                    G.FillRectangle(WhitePen, New Rectangle((i * (SIZE_BOX + (SIZE_BORDER * 2))) + SIZE_BORDER, (j * (SIZE_BOX + (SIZE_BORDER * 2))) + SIZE_BORDER, SIZE_BOX, SIZE_BOX))
                    arr(i) = arr(i) Xor (2 ^ j)
                Else
                    G.FillRectangle(BlackPen, New Rectangle((i * (SIZE_BOX + (SIZE_BORDER * 2))) + SIZE_BORDER, (j * (SIZE_BOX + (SIZE_BORDER * 2))) + SIZE_BORDER, SIZE_BOX, SIZE_BOX))
                End If
            Next
        Next
        MainPictureBox.Image = BM
        ImageToArray()
    End Sub

    Sub RotateBw()

        G.RotateTransform(270, Drawing2D.MatrixOrder.Prepend)
        G.TranslateTransform(-(((SIZE_BOX + (SIZE_BORDER * 2)) * MAX_ROW) - 1), -0)
        G.DrawImage(BM, 0, 0)

        MainPictureBox.Image = BM

        ImageToArray()
        G = Graphics.FromImage(BM)
        Image_Clear()
        ArrayToImage()
    End Sub

    Sub RotateFw()

        G.RotateTransform(-270, Drawing2D.MatrixOrder.Prepend)
        G.TranslateTransform(0, -(((SIZE_BOX + (SIZE_BORDER * 2)) * MAX_ROW) - 1))

        G.DrawImage(BM, 0, 0)

        ImageToArray()
        G = Graphics.FromImage(BM)
        Image_Clear()
        ArrayToImage()
    End Sub

    Sub TextBoxToImage(sender As Object, evt As MouseEventArgs)

        On Error Resume Next
        If rbSelectMode.Checked = True Then
            Dim box = DirectCast(sender, RichTextBox)
            Dim index = box.GetCharIndexFromPosition(evt.Location)
            Dim line = box.GetLineFromCharIndex(index)
            Dim lineStart = box.GetFirstCharIndexFromLine(line)
            Dim lineEnd = box.GetFirstCharIndexFromLine(line + 1) '- 1
            box.SelectionStart = lineStart
            box.SelectionLength = lineEnd - lineStart

            StringForParse = box.Text.Substring(lineStart, lineEnd - lineStart)
            GetArrayOfHexFromStr(StringForParse)
            ArrayToImage()
        End If

        Err.Clear()
    End Sub


    Function GetArrayOfHexFromStr(ByVal str As String) As String

        Dim ValArr(MAX_ROW) As String
        Dim j = 0

        For i = 0 To str.Length - 3 Step 3
            If str.Chars(i) = "0" And (str.Chars(i + 1) = "x" Or str.Chars(i + 1) = "X") Then
                ValArr(j) = "0x" & str.Chars(i + 2) & str.Chars(i + 3)
                j = j + 1
            End If
        Next

        For i = 0 To j - 1
            arr(i) = Convert.ToInt32(ValArr(i), 16)
        Next
    End Function

    Function RotateHexFromStr(ByVal str As String) As String

        Dim ValArr(MAX_ROW) As String
        Dim j = 0

        For i = 0 To str.Length - 3 Step 3
            If str.Chars(i) = "0" And (str.Chars(i + 1) = "x" Or str.Chars(i + 1) = "X") Then
                ValArr(j) = "0x" & str.Chars(i + 2) & str.Chars(i + 3)
                j = j + 1
            End If
        Next

        For i = 0 To j - 1
            arr(i) = Convert.ToInt32(ValArr(i), 16)
        Next

        ArrayToImage()

        If cbRotateCount.SelectedIndex > 0 Then
            For i = 1 To cbRotateCount.SelectedIndex
                RotateFw()
            Next
        End If

        j = 0

        For i = 0 To str.Length - 3 Step 3
            If str.Chars(i) = "0" And (str.Chars(i + 1) = "x" Or str.Chars(i + 1) = "X") Then
                str = str.Remove(i, 4)
                str = str.Insert(i, ByteToHex(arr(j)))
                j = j + 1
            End If
        Next

        Return str
    End Function

End Class
